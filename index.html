<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Faithwin Gbadamosi">
<meta name="dcterms.date" content="2024-11-10">

<title>Predicting Diabetes Using Logistic Regression in R – Faithwin’s GEO511 FinalProject</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Faithwin’s GEO511 FinalProject</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predicting Diabetes Using Logistic Regression in R</h1>
<p class="subtitle lead">Final Project for Geo 511</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Faithwin Gbadamosi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 10, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The disease “Diabetes Mellitus” is one of the most common critical diseases in the world. According to the World Health Organization (WHO), approximately 422 million people worldwide currently live with diabetes, with the majority residing in low- and middle-income countries (World Health Organization, 2023). The disease is characterized by elevated levels of blood glucose (or blood sugar), which leads over time to serious damage to the heart, blood vessels, eyes, kidneys and nerves.</p>
<p>For people at risk of diabetes, healthcare professionals have stressed the value of routine tests, emphasizing the necessity of early detection and intervention (Pranto eta al., 2020). In addition to diabetes care, prevention is essential. Prediction of diabetes from the onset can help healthcare providers take early preventive measures (Talukder et al., 2024).</p>
<p>This project aims to build a predictive model for diabetes using readily available patient data and key variables, such as pregnancies, glucose levels, BMI, and genetic factors. In addition, I will create visual summaries to communicate the insights and patterns identified in the data. The major objectives include:</p>
<ol type="1">
<li><p>Collecting and cleaning the diabetes dataset with relevant health variables.</p></li>
<li><p>Applying machine learning algorithm (logistic regression) to predict diabetes cases.</p></li>
<li><p>Creating visual summaries to show the relationships between key variables.</p></li>
</ol>
</section>
<section id="materials-and-methods" class="level1">
<h1>Materials and methods</h1>
<section id="the-data" class="level3">
<h3 class="anchored" data-anchor-id="the-data"><strong>The Data</strong></h3>
<p>The dataset used in this project was found in a study by Chou et al., (2023). The outpatient examination data of a Taipei Municipal medical center was taken as the patient population and 15,000 women aged between 20 and 80 were selected as the samples. The women were patients who had gone to the hospital between 2018 and 2020 and between 2021 and 2022 and may or may not have been diagnosed with diabetes.</p>
<p>The dataset contains the following variables:</p>
<p>1. Pregnancies: Number of times pregnant</p>
<p>2. PlasmaGlucose: two hours following an oral glucose tolerance test, plasma glucose concentration</p>
<p>3. DiastolicBloodPressure: Diastolic blood pressure (mm Hg)</p>
<p>4. TricepsThickness: Triceps skin fold thickness (mm)</p>
<p>5. SerumInsulin: 2-Hour serum insulin (mu U/ml)</p>
<p>6. BMI: Body mass index (weight in kg/(height in m)^2)</p>
<p>7. DiabetesPedigree: a numerical estimate of an individual’s genetic risk for developing diabetes based on family history. A higher score indicates a greater likelihood of developing the condition.</p>
<p>8. Age: Age (years)</p>
<p>9. Diabetic Outcome: Class variable (0 or 1) with the class value 1 representing those who tested positive for diabetes.</p>
<p>Dataset can be found here: (<a href="https://drive.google.com/file/d/1eAplOYO-k7ZYHj4uHAY1tEr8VTeaxS6u/view?usp=sharing" class="uri">https://drive.google.com/file/d/1eAplOYO-k7ZYHj4uHAY1tEr8VTeaxS6u/view?usp=sharing</a>).</p>
</section>
<section id="required-steps-to-build-model" class="level3">
<h3 class="anchored" data-anchor-id="required-steps-to-build-model">Required Steps to Build Model</h3>
<ol type="1">
<li><p>Load necessary packages</p></li>
<li><p>Load and explore the dataset</p></li>
<li><p>Data visualization and exploratory analysis</p></li>
<li><p>Preprocess data and Train model</p></li>
<li><p>Evaluate model</p></li>
<li><p>Make prediction with case study</p></li>
<li><p>ROC Curve</p></li>
</ol>
</section>
<section id="load-required-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-required-packages">Load Required Packages</h3>
<p>Loading necessary r packages to aid analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"corrplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following package(s) will be installed:
- corrplot [0.95]
These packages will be installed into "~/work/Faithwinn_Final_Project/Faithwinn_Final_Project/renv/library/linux-ubuntu-jammy/R-4.4/x86_64-pc-linux-gnu".

# Installing packages --------------------------------------------------------
- Installing corrplot ...                       OK [linked from cache]
Successfully installed 1 package in 8 milliseconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"caret"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following package(s) will be installed:
- caret [6.0-94]
These packages will be installed into "~/work/Faithwinn_Final_Project/Faithwinn_Final_Project/renv/library/linux-ubuntu-jammy/R-4.4/x86_64-pc-linux-gnu".

# Installing packages --------------------------------------------------------
- Installing caret ...                          OK [linked from cache]
Successfully installed 1 package in 7 milliseconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"kableExtra"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following package(s) will be installed:
- kableExtra [1.4.0]
These packages will be installed into "~/work/Faithwinn_Final_Project/Faithwinn_Final_Project/renv/library/linux-ubuntu-jammy/R-4.4/x86_64-pc-linux-gnu".

# Installing packages --------------------------------------------------------
- Installing kableExtra ...                     OK [linked from cache]
Successfully installed 1 package in 7 milliseconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(widgetframe)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2) <span class="co">#for melt function</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown) </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">widgetframe_widgets_dir =</span> <span class="st">'widgets'</span> ) </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">cache=</span><span class="cn">TRUE</span>)  <span class="co"># cache the results for quick compiling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-and-explore-data" class="level3">
<h3 class="anchored" data-anchor-id="load-and-explore-data">Load and Explore Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>diabetes_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://drive.google.com/uc?export=download&amp;id=1eAplOYO-k7ZYHj4uHAY1tEr8VTeaxS6u"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Exploring the dataset</p>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>diabetes_data<span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co">#show only 1:n rows</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits=</span><span class="dv">2</span>,<span class="at">align=</span><span class="st">"c"</span>)<span class="sc">%&gt;%</span> <span class="co">#make table and round to two digits</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">PatientID</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Pregnancies</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">PlasmaGlucose</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">DiastolicBloodPressure</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">TricepsThickness</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">SerumInsulin</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">BMI</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">DiabetesPedigree</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Age</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Diabetic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1354778</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">171</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">34</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">43.51</td>
<td style="text-align: center;">1.21</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">1147438</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">93</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">21.24</td>
<td style="text-align: center;">0.16</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1640031</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">115</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">52</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">41.51</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">1883350</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">103</td>
<td style="text-align: center;">78</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">304</td>
<td style="text-align: center;">29.58</td>
<td style="text-align: center;">1.28</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1424119</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">59</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">42.60</td>
<td style="text-align: center;">0.55</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">1619297</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">82</td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">253</td>
<td style="text-align: center;">19.72</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1660149</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">133</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">227</td>
<td style="text-align: center;">21.94</td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">1458769</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">67</td>
<td style="text-align: center;">87</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">18.28</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1201647</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">33</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">26.62</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;">53</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">1403912</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">72</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">36.89</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>


<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Exploring the structure of the data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(diabetes_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   15000 obs. of  10 variables:
 $ PatientID             : int  1354778 1147438 1640031 1883350 1424119 1619297 1660149 1458769 1201647 1403912 ...
 $ Pregnancies           : int  0 8 7 9 1 0 0 0 8 1 ...
 $ PlasmaGlucose         : int  171 92 115 103 85 82 133 67 80 72 ...
 $ DiastolicBloodPressure: int  80 93 47 78 59 92 47 87 95 31 ...
 $ TricepsThickness      : int  34 47 52 25 27 9 19 43 33 40 ...
 $ SerumInsulin          : int  23 36 35 304 35 253 227 36 24 42 ...
 $ BMI                   : num  43.5 21.2 41.5 29.6 42.6 ...
 $ DiabetesPedigree      : num  1.213 0.158 0.079 1.283 0.55 ...
 $ Age                   : int  21 23 23 43 22 26 21 26 53 26 ...
 $ Diabetic              : int  0 0 0 1 0 0 0 0 1 0 ...</code></pre>
</div>
</div>
<p>The dataset contains 15000 patient entries, with all features being numeric values.</p>
<section id="clean-dataset" class="level5">
<h5 class="anchored" data-anchor-id="clean-dataset">Clean Dataset</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duplicated</span>(diabetes_data) <span class="co">#check for duplicates</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(diabetes_data)) <span class="co">#to check missing values </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The dataset contains no duplicates or missing values. The next step is visual summary.</p>
</section>
</section>
<section id="data-visualization-and-exploratory-analysis" class="level3">
<h3 class="anchored" data-anchor-id="data-visualization-and-exploratory-analysis">Data Visualization and Exploratory Analysis</h3>
<p>Correlation and visual summary</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remove patientid and outcome for better analysis </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>filtered_diabetes <span class="ot">&lt;-</span> <span class="fu">subset</span>(diabetes_data, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(PatientID,Diabetic))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(filtered_diabetes)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert correlation matrix from wide to long format for easier analysis</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>correlation_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(correlation_matrix)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#see the outcome</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>correlation_melted<span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits=</span><span class="dv">8</span>,<span class="at">align=</span><span class="st">"c"</span>)<span class="sc">%&gt;%</span> <span class="co">#make table and round to two digits</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>,  <span class="at">fixed_thead =</span> <span class="cn">TRUE</span>))<span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>) <span class="co">#scroll option long table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Var1</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">Var2</th>
<th data-quarto-table-cell-role="th" style="text-align: center; position: sticky; top: 0; background-color: #FFFFFF;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">1.00000000</td>
</tr>
<tr class="even">
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">0.05450238</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">0.04352845</td>
</tr>
<tr class="even">
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">0.06360454</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">0.10448699</td>
</tr>
<tr class="even">
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">0.08638610</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">0.05424006</td>
</tr>
<tr class="even">
<td style="text-align: center;">Age</td>
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">0.13697248</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">0.05450238</td>
</tr>
<tr class="even">
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">1.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">0.00721196</td>
</tr>
<tr class="even">
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">0.02709960</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">0.03354493</td>
</tr>
<tr class="even">
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">0.02065333</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">0.00905733</td>
</tr>
<tr class="even">
<td style="text-align: center;">Age</td>
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">0.03886361</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">0.04352845</td>
</tr>
<tr class="even">
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">0.00721196</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">1.00000000</td>
</tr>
<tr class="even">
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">0.01110606</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">0.02264855</td>
</tr>
<tr class="even">
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">0.01587319</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">0.01409873</td>
</tr>
<tr class="even">
<td style="text-align: center;">Age</td>
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">0.04133254</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">0.06360454</td>
</tr>
<tr class="even">
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">0.02709960</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">0.01110606</td>
</tr>
<tr class="even">
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">1.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">0.02968762</td>
</tr>
<tr class="even">
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">0.02474548</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">-0.00095109</td>
</tr>
<tr class="even">
<td style="text-align: center;">Age</td>
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">0.06138287</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">0.10448699</td>
</tr>
<tr class="even">
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">0.03354493</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">0.02264855</td>
</tr>
<tr class="even">
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">0.02968762</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">1.00000000</td>
</tr>
<tr class="even">
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">0.05122315</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">0.04632376</td>
</tr>
<tr class="even">
<td style="text-align: center;">Age</td>
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">0.08800683</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">0.08638610</td>
</tr>
<tr class="even">
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">0.02065333</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">0.01587319</td>
</tr>
<tr class="even">
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">0.02474548</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">0.05122315</td>
</tr>
<tr class="even">
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">1.00000000</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">0.02886835</td>
</tr>
<tr class="even">
<td style="text-align: center;">Age</td>
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">0.06290975</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">0.05424006</td>
</tr>
<tr class="even">
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">0.00905733</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">0.01409873</td>
</tr>
<tr class="even">
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">-0.00095109</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">0.04632376</td>
</tr>
<tr class="even">
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">0.02886835</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">1.00000000</td>
</tr>
<tr class="even">
<td style="text-align: center;">Age</td>
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">0.05563319</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Pregnancies</td>
<td style="text-align: center;">Age</td>
<td style="text-align: center;">0.13697248</td>
</tr>
<tr class="even">
<td style="text-align: center;">PlasmaGlucose</td>
<td style="text-align: center;">Age</td>
<td style="text-align: center;">0.03886361</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiastolicBloodPressure</td>
<td style="text-align: center;">Age</td>
<td style="text-align: center;">0.04133254</td>
</tr>
<tr class="even">
<td style="text-align: center;">TricepsThickness</td>
<td style="text-align: center;">Age</td>
<td style="text-align: center;">0.06138287</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SerumInsulin</td>
<td style="text-align: center;">Age</td>
<td style="text-align: center;">0.08800683</td>
</tr>
<tr class="even">
<td style="text-align: center;">BMI</td>
<td style="text-align: center;">Age</td>
<td style="text-align: center;">0.06290975</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DiabetesPedigree</td>
<td style="text-align: center;">Age</td>
<td style="text-align: center;">0.05563319</td>
</tr>
<tr class="even">
<td style="text-align: center;">Age</td>
<td style="text-align: center;">Age</td>
<td style="text-align: center;">1.00000000</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
</div>
<p>Plot correlation heatmap</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot heatmap</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(correlation_melted, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span> <span class="st">"blue"</span>, <span class="at">high=</span><span class="st">"red"</span>, <span class="at">mid=</span><span class="st">"white"</span>, <span class="at">midpoint=</span><span class="dv">0</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limit=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">space =</span> <span class="st">"Lab"</span>, <span class="at">name=</span><span class="st">"Correlation"</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="co">#so the xlabs are not scrunched together</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Correlation Heatmap"</span>, <span class="at">x=</span><span class="st">"Features"</span>, <span class="at">y=</span><span class="st">"Features"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption>Correlation HeatMap</figcaption>
</figure>
</div>
</div>
</div>
<p>The correlation shows moderately positive correlations between the Age and Pregnancy, and the Insulin and Pregnancy. This indicates that as the age of the patients increased so did the number of pregnancies, also as the number of pregnancies, the quantity of insulin administered to the patients increased likewise.</p>
<p>Weak or no correlations can also be observed in the following attributes of the dataset; DiabetesPedigree and Skin Thickness.</p>
<section id="comparing-outcomes-and-variables" class="level5">
<h5 class="anchored" data-anchor-id="comparing-outcomes-and-variables">Comparing Outcomes and Variables</h5>
<p>Age vs Outcome</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diabetes_data, <span class="fu">aes</span>(<span class="at">x =</span> Age)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diabetic) <span class="sc">+</span> <span class="fu">theme_dark</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Number of Patients"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age(s) of Patients"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption>Graph Showing Correlation of Outcome vs Age</figcaption>
</figure>
</div>
</div>
</div>
<p>0 = Non-diabetic</p>
<p>1= Diabetic</p>
<p>The ages of the patients are skewed to the right with most of the patients being between the ages of 20 to 40.</p>
<p>BMI vs Outcome</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diabetes_data, <span class="fu">aes</span>(<span class="at">x =</span> BMI)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diabetic) <span class="sc">+</span> <span class="fu">theme_dark</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Number of Patients"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BMI of Patients"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption>Plot Showing Correlation Between Outcome vs BMI</figcaption>
</figure>
</div>
</div>
</div>
<p>Blood Pressure vs Outcome</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diabetes_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Diabetic), <span class="at">y =</span> DiastolicBloodPressure, <span class="at">fill =</span> <span class="fu">factor</span>(Diabetic))) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Patients' Blood Pressure"</span>, <span class="at">x =</span> <span class="st">"Diabetes Status"</span>, <span class="at">fill =</span> <span class="st">"Diabetes Status"</span> ) <span class="sc">+</span> <span class="fu">scale_fill_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Non-Diabetic"</span>, <span class="st">"Diabetic"</span>)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption>Boxplot Showing Correlation Between Outcome vs BloodPressure</figcaption>
</figure>
</div>
</div>
</div>
<p>Visualizing the distribution of blood pressure for each outcome.</p>
</section>
</section>
<section id="preprocess-and-train-data" class="level3">
<h3 class="anchored" data-anchor-id="preprocess-and-train-data">Preprocess and Train Data</h3>
<section id="preprocess" class="level5">
<h5 class="anchored" data-anchor-id="preprocess">Preprocess</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Convert the outcome variable to a factor </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>diabetes_data<span class="sc">$</span>Diabetic <span class="ot">&lt;-</span> <span class="fu">factor</span>(diabetes_data<span class="sc">$</span>Diabetic, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Non-Diabetic"</span>, <span class="st">"Diabetic"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Split the data into training and testing sets</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(diabetes_data<span class="sc">$</span>Diabetic, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> diabetes_data[split, ]</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> diabetes_data[<span class="sc">-</span>split, ]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Fit the logistic regression model</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>diabetes_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Diabetic <span class="sc">~</span> Pregnancies <span class="sc">+</span> PlasmaGlucose <span class="sc">+</span> DiastolicBloodPressure <span class="sc">+</span> TricepsThickness <span class="sc">+</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                       SerumInsulin <span class="sc">+</span> BMI <span class="sc">+</span> DiabetesPedigree <span class="sc">+</span> Age,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> train_data, <span class="at">family =</span> binomial)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Summarize the model to see coefficients and other details</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diabetes_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Diabetic ~ Pregnancies + PlasmaGlucose + DiastolicBloodPressure + 
    TricepsThickness + SerumInsulin + BMI + DiabetesPedigree + 
    Age, family = binomial, data = train_data)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            -8.7112122  0.2194791 -39.690  &lt; 2e-16 ***
Pregnancies             0.2698705  0.0080060  33.709  &lt; 2e-16 ***
PlasmaGlucose           0.0096941  0.0008234  11.773  &lt; 2e-16 ***
DiastolicBloodPressure  0.0121392  0.0015853   7.657  1.9e-14 ***
TricepsThickness        0.0226795  0.0018192  12.467  &lt; 2e-16 ***
SerumInsulin            0.0039586  0.0001944  20.367  &lt; 2e-16 ***
BMI                     0.0486785  0.0027794  17.514  &lt; 2e-16 ***
DiabetesPedigree        1.0392443  0.0670211  15.506  &lt; 2e-16 ***
Age                     0.0590712  0.0020860  28.318  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 13366.8  on 10499  degrees of freedom
Residual deviance:  9151.1  on 10491  degrees of freedom
AIC: 9169.1

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="train-model" class="level5">
<h5 class="anchored" data-anchor-id="train-model">Train Model</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate predictions on the test set</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(diabetes_model, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>predicted_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(test_data<span class="sc">$</span>predicted_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"Diabetic"</span>, <span class="st">"Non-Diabetic"</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Non-Diabetic"</span>, <span class="st">"Diabetic"</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create confusion matrix</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(<span class="at">data =</span> test_data<span class="sc">$</span>predicted_class,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">reference =</span> test_data<span class="sc">$</span>Diabetic,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">positive =</span> <span class="st">"Diabetic"</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print confusion matrix and statistics</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

              Reference
Prediction     Non-Diabetic Diabetic
  Non-Diabetic         2671      627
  Diabetic              329      873
                                          
               Accuracy : 0.7876          
                 95% CI : (0.7753, 0.7994)
    No Information Rate : 0.6667          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.497           
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.5820          
            Specificity : 0.8903          
         Pos Pred Value : 0.7263          
         Neg Pred Value : 0.8099          
             Prevalence : 0.3333          
         Detection Rate : 0.1940          
   Detection Prevalence : 0.2671          
      Balanced Accuracy : 0.7362          
                                          
       'Positive' Class : Diabetic        
                                          </code></pre>
</div>
</div>
</section>
<section id="case-study" class="level4">
<h4 class="anchored" data-anchor-id="case-study">Case Study</h4>
<p>Predicting diabetes for a new patient named Molly_Jane.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the new patient's data for prediction</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Molly_Jane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pregnancies =</span> <span class="dv">2</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">PlasmaGlucose =</span> <span class="dv">120</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a> <span class="at">DiastolicBloodPressure =</span> <span class="dv">70</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">TricepsThickness =</span> <span class="dv">30</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">SerumInsulin =</span> <span class="dv">85</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">BMI =</span> <span class="fl">28.5</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">DiabetesPedigree =</span> <span class="fl">0.627</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> <span class="dv">45</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the model to predict the probability for the new patient</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>prediction_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(diabetes_model, <span class="at">newdata =</span> Molly_Jane, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert probability to class prediction with explicit labeling</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>prediction_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prediction_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"Diabetic"</span>, <span class="st">"Non-Diabetic"</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results with formatted probability and text label</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Predicted probability of diabetes:"</span>, <span class="fu">round</span>(prediction_prob, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)<span class="co">#rounded to 3 decimal points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Predicted probability of diabetes: 0.391 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Predicted class for the new patient:"</span>, prediction_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Predicted class for the new patient: Non-Diabetic</code></pre>
</div>
</div>
<p>With a probability of 39.1 %, Molly_Jane is classified as Non-Diabetic.</p>
</section>
<section id="roc-curve" class="level4">
<h4 class="anchored" data-anchor-id="roc-curve">ROC Curve</h4>
</section>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(test_data<span class="sc">$</span>Diabetic, test_data<span class="sc">$</span>predicted_prob, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Non-Diabetic"</span>, <span class="st">"Diabetic"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">main =</span> <span class="st">"ROC Curve for Diabetes Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption>Model’s ROC Curve</figcaption>
</figure>
</div>
</div>
</div>
<p>The Receiver’s Operating Characteristic (ROC) shows the overall performance of the model is good. With an AUC (Area Under the Curve) of about 0.8 or higher, the model will be about 80% of the time accurate in predicting if a patient is diabetic or non-diabetic.</p>
</section>
</section>
<section id="conclusions" class="level3">
<h3 class="anchored" data-anchor-id="conclusions">Conclusions</h3>
<p>[~200 words]</p>
<p>Clear summary adequately describing the results and putting them in context. Discussion of further questions and ways to continue investigation.</p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Chou C-Y, Hsu D-Y, Chou C-H. Predicting the Onset of Diabetes with Machine Learning Methods.&nbsp;<em>Journal of Personalized Medicine</em>. 2023; 13(3):406. https://doi.org/10.3390/jpm13030406</p>
<p>Geeks for Geeks Prediction Using R Course: <a href="https://www.geeksforgeeks.org/diabetes-prediction-using-r/" class="uri">https://www.geeksforgeeks.org/diabetes-prediction-using-r/</a></p>
<p>Pranto B, Mehnaz S, Mahid EB et al.&nbsp;Evaluating machine learning methods for predicting diabetes among female patients in bangladesh.&nbsp;<em>Information</em>&nbsp;2020; 11: 374.</p>
<p>Talukder MdA, Islam MdM, Uddin MA, et al.&nbsp;Toward reliable diabetes prediction: Innovations in data engineering and machine learning applications. DIGITAL HEALTH. 2024;10. doi:10.1177/20552076241271867</p>
<p>Tamunoye Darego (2022) Diabetes Prediction using kNN in R</p>
<p>World Health Organization&nbsp;(2023): <a href="https://www.who.int/news-room/fact-sheets/detail/diabetes" class="uri">https://www.who.int/news-room/fact-sheets/detail/diabetes</a></p>
<p>Xavier Robin, Natacha Turck, Alexandre Hainard, Natalia Tiberti, Frédérique Lisacek, Jean-Charles Sanchez and Markus Müller (2011). “pROC: an open-source package for R and S+ to analyze and compare ROC curves”.&nbsp;<em>BMC Bioinformatics</em>,&nbsp;<strong>12</strong>, p.&nbsp;77. DOI: doi:&nbsp;<a href="https://doi.org/10.1186/1471-2105-12-77">10.1186/1471-2105-12-77</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/AdamWilsonLabEDU\.github\.io\/Faithwinn_Final_Project\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>